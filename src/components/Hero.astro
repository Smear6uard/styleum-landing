---
// Hero.astro - Editorial video hero with iOS download
---

<section id="hero" class="relative min-h-screen overflow-hidden">

  <!-- Video background (shows when video files exist) -->
  <video
    id="hero-video"
    autoplay
    loop
    muted
    playsinline
    poster="/video/hero-poster.jpg"
    class="absolute inset-0 w-full h-full object-cover"
  >
    <source src="/video/hero.webm" type="video/webm" />
    <source src="/video/hero.mp4" type="video/mp4" />
  </video>

  <!-- Fallback gradient (shown if video doesn't load) -->
  <div id="hero-fallback" class="absolute inset-0 bg-[#1A1816]">
    <div class="absolute inset-0 bg-gradient-to-br from-[#2a2520] via-[#1A1816] to-[#0d0b0a]"></div>
  </div>

  <!-- Dark overlay for text legibility -->
  <div class="absolute inset-0 bg-black/40"></div>

  <!-- Subtle grain texture -->
  <div class="absolute inset-0 opacity-[0.04] pointer-events-none" style="background-image: url('data:image/svg+xml,%3Csvg viewBox=%270 0 400 400%27 xmlns=%27http://www.w3.org/2000/svg%27%3E%3Cfilter id=%27noiseFilter%27%3E%3CfeTurbulence type=%27fractalNoise%27 baseFrequency=%270.9%27 numOctaves=%274%27 stitchTiles=%27stitch%27/%3E%3C/filter%3E%3Crect width=%27100%25%27 height=%27100%25%27 filter=%27url(%23noiseFilter)%27/%3E%3C/svg%3E');"></div>

  <!-- Content layer -->
  <div id="hero-content" class="relative z-10 min-h-screen flex flex-col justify-between px-6 lg:px-12 py-8 lg:py-12">

    <!-- Masthead -->
    <header class="flex items-start justify-between">
      <div class="flex items-center gap-2">
        <img src="/StyleumLogo1.png" alt="" class="h-4 w-4 invert opacity-60" />
        <span class="text-[10px] sm:text-xs tracking-[0.4em] uppercase text-white/60 font-medium">
          Styleum
        </span>
      </div>
    </header>

    <!-- Headline - positioned in lower portion -->
    <div class="flex-1 flex items-end pb-8 lg:pb-12">
      <div class="max-w-4xl">
        <h1 class="font-display font-bold text-white leading-[0.95] tracking-[-0.03em]">
          <span class="block text-[15vw] sm:text-[12vw] lg:text-[10vw] xl:text-[9vw]">YOUR</span>
          <span class="block text-[15vw] sm:text-[12vw] lg:text-[10vw] xl:text-[9vw]">MORNING,</span>
          <span class="block text-[15vw] sm:text-[12vw] lg:text-[10vw] xl:text-[9vw] text-white/70">HANDLED.</span>
        </h1>
      </div>
    </div>

    <!-- iOS Download CTA -->
    <footer class="flex items-end justify-between">
      <a
        href="#"
        class="group inline-flex items-center gap-3 bg-white text-[#1A1816] px-5 py-3 rounded-full hover:bg-white/90 transition-colors"
      >
        <!-- Apple logo -->
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
          <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
        </svg>
        <span class="text-sm font-medium">Download for iOS</span>
      </a>

      <span class="text-[10px] sm:text-xs text-white/40 tracking-wide hidden sm:block">
        Scroll
      </span>
    </footer>

  </div>

</section>

<script>
  // Video fallback handling
  const video = document.getElementById('hero-video') as HTMLVideoElement;
  const fallback = document.getElementById('hero-fallback');

  if (video && fallback) {
    // Hide fallback if video can play
    video.addEventListener('canplay', () => {
      fallback.style.opacity = '0';
    });

    // Show fallback if video fails
    video.addEventListener('error', () => {
      fallback.style.opacity = '1';
      video.style.display = 'none';
    });

    // Handle case where video source doesn't exist
    if (!video.currentSrc || video.networkState === 3) {
      fallback.style.opacity = '1';
    }
  }

  // Scroll fade effect for hero content
  const heroContent = document.getElementById('hero-content');
  const hero = document.getElementById('hero');

  if (heroContent && hero) {
    let ticking = false;

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(() => {
          const scrollY = window.scrollY;
          const heroHeight = hero.offsetHeight;
          const fadeEnd = heroHeight * 0.5;
          const progress = Math.min(scrollY / fadeEnd, 1);

          const opacity = 1 - progress;
          const translateY = progress * -40;

          heroContent.style.opacity = String(Math.max(opacity, 0));
          heroContent.style.transform = `translateY(${translateY}px)`;

          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });
  }
</script>

<style>
  #hero-content {
    transition: opacity 0.15s ease-out, transform 0.15s ease-out;
    will-change: opacity, transform;
  }

  #hero-fallback {
    transition: opacity 0.5s ease;
  }

  #hero-video {
    z-index: 1;
  }

  #hero-fallback {
    z-index: 0;
  }
</style>
